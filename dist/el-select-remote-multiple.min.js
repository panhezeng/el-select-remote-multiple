!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("element-ui"),require("@panhezeng/utils/dist/get-object-item-by-path.js")):"function"==typeof define&&define.amd?define("ElSelectRemoteMultiple",["element-ui","@panhezeng/utils/dist/get-object-item-by-path.js"],t):"object"==typeof exports?exports.ElSelectRemoteMultiple=t(require("element-ui"),require("@panhezeng/utils/dist/get-object-item-by-path.js")):e.ElSelectRemoteMultiple=t(e.ELEMENT,e.getObjectItemByPath)}(window,function(e,t){return function(e){var t={};function i(l){if(t[l])return t[l].exports;var n=t[l]={i:l,l:!1,exports:{}};return e[l].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,l){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(l,n,function(t){return e[t]}.bind(null,n));return l},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t,i){"use strict";i.r(t),i.d(t,"ElSelectRemoteMultiple",function(){return l});const l=i(3).default;let n;function a(e,t="undefined"!=typeof window&&window.ElSelectRemoteMultipleOptions){n?console.warn("[ElSelectRemoteMultiple] already installed. Vue.use(ElSelectRemoteMultiple) should be called only once."):(n=e,"[object Object]"===Object.prototype.toString.call(t)&&t.ajax instanceof Object&&t.ajax.hasOwnProperty("get")&&t.ajax.hasOwnProperty("post")&&Object.assign(l.props.ajax,{required:!1,default:()=>t.ajax}),n.component(l.name,l))}l.install=a,"undefined"!=typeof window&&window.Vue&&a(window.Vue)},function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-select",e._g(e._b({staticStyle:{width:"100%"},attrs:{placeholder:e.placeholder,disabled:e.disabled,multiple:"",filterable:"",remote:"","remote-method":e.getLabelsOptions,loading:e.labelsLoading},on:{change:e.updateSelected},scopedSlots:e._u([{key:"prefix",fn:function(){return[e._t("prefix")]},proxy:!0},{key:"empty",fn:function(){return[e._t("empty")]},proxy:!0}],null,!0),model:{value:e.labelsSelected,callback:function(t){e.labelsSelected=t},expression:"labelsSelected"}},"el-select",e.$attrs,!1),e.$listeners),[e._t("default"),e._v(" "),e._v(" "),e._v(" "),e._l(e.labelsOptions,function(t){return[t&&t[e.valueKey]?[i("el-option",{key:t[e.valueKey],attrs:{label:t[e.labelKey],value:t[e.valueKey]}})]:e._e()]})],2),e._v(" "),e._t("default")],2)};l._withStripped=!0;var n=i(0),a=i(1),s=i.n(a);var o=function(e,t,i,l,n,a,s,o){var r,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),l&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),s?(r=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=r):n&&(r=o?function(){n.call(this,this.$root.$options.shadowRoot)}:n),r)if(c.functional){c._injectStyles=r;var p=c.render;c.render=function(e,t){return r.call(t),p(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,r):[r]}return{exports:e,options:c}}({name:"ElSelectRemoteMultiple",components:{"el-select":n.Select,"el-option":n.Option},inheritAttrs:!1,props:{selectedObj:{type:Array,required:!0,default:()=>[]},selected:{type:Array,default:()=>[]},labelKey:{type:String,default:"name"},valueKey:{type:String,default:"id"},ajax:{validator:e=>e instanceof Object&&e.hasOwnProperty("get")&&e.hasOwnProperty("post"),required:!0},apiOptionsUrl:{type:String,required:!0},apiOptionsParamKeys:{type:Object,default:()=>({limit:"limit",offset:"offset",search:"search"})},apiOptionsLimit:{type:Number,default:10},apiOptionsResPath:{type:String,default:"data"},apiOptionsCallback:{type:Function,default:void 0},apiCreateUrl:{type:String,default:""},apiCreateResPath:{type:String,default:"data"},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:""}},data:()=>({labelsSelected:[],labelsOptions:[],labelsLoading:!1,needInitData:!0}),watch:{selectedObj:{immediate:!0,handler(e,t){this.initData(),this.needInitData=!0}}},methods:{initData(){this.needInitData&&(this.labelsOptions=this.selectedObj,this.labelsSelected=this.selectedObj.reduce((e,t)=>("[object Object]"===Object.prototype.toString.call(t)&&t[this.valueKey]&&e.push(t[this.valueKey]),e),[]),this.$emit("update:selected",this.labelsSelected.slice()),this.$nextTick(function(){this.labelsOptions=[]}))},async updateSelected(){const e=this.labelsOptions=this.selectedObj.concat(this.labelsOptions),t=[];for(let i=this.labelsSelected.length;i--;){const l=this.labelsSelected[i],n=e.find(e=>String(e[this.valueKey])===String(l));if("[object Object]"===Object.prototype.toString.call(n))if("ElSelectRemoteMultipleCreateTempPlaceholderValue"===String(l))try{const e=await this.ajax.post(this.apiCreateUrl,{[this.labelKey]:n[this.labelKey]}),l=s()(e,this.apiCreateResPath);t.push(l),this.labelsOptions.push(l),this.labelsSelected[i]=l[this.valueKey]}catch(e){this.labelsSelected.splice(i,1)}else t.push(n);else this.labelsSelected.splice(i,1)}this.needInitData=!1,this.$emit("update:selectedObj",t),this.$emit("update:selected",this.labelsSelected.slice()),this.$nextTick(function(){this.labelsOptions=[]})},async getLabelsOptions(e=""){let t=[];if(this.labelsLoading=!0,e=String(e).trim())try{const i=await this.ajax.get(this.apiOptionsUrl,{params:{[this.apiOptionsParamKeys.limit]:this.apiOptionsLimit,[this.apiOptionsParamKeys.offset]:0,[this.apiOptionsParamKeys.search]:e}});if(t=s()(i,this.apiOptionsResPath),"[object Array]"===Object.prototype.toString.call(t)){const i=t.findIndex(t=>String(t[this.labelKey])===e);if(-1===i){const i=this.selectedObj.find(t=>String(t[this.labelKey])===String(e));"[object Object]"===Object.prototype.toString.call(i)?t.unshift(i):this.apiCreateUrl&&t.unshift({[this.labelKey]:e,[this.valueKey]:"ElSelectRemoteMultipleCreateTempPlaceholderValue"})}else if(i>0){const e=t[0];t[0]=t[i],t[i]=e}}else t=[]}catch(e){}"[object Function]"===Object.prototype.toString.call(this.apiOptionsCallback)&&this.apiOptionsCallback(t),this.labelsOptions=t,this.labelsLoading=!1}}},l,[],!1,null,null,null);o.options.__file="src/ElSelectRemoteMultiple.vue";t.default=o.exports}]).ElSelectRemoteMultiple});